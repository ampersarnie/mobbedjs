/*

	mobbed.js v0.1

	by Paul Taylor     http://ampersandwich.co.uk
	Twitter:           @ampersarnie
	ADN:               @pmt
	Latest version:    https://github.com/ampersarnie/mobbedjs

	mobbed.js, furthering responsive design for quicker mobile loading.

*/function inArray(e,t){for(var n in t)if(e===t[n])return e;return!1}function isId(e){return e[0]=="#"?!0:!1}function hasId(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<t.length;r++)if(t[r]==e[n])return!0;return!1}function isClass(e){return e[0]=="."?!0:!1}function hasClass(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<t.length;r++)if(t[r]==e[n])return!0;return!1}function randString(){var e="",t="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<5;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}var mobbed=function(e,t){function b(){e&&N(settings,e);html=document.documentElement.outerHTML;if(html.match(/<\/html>/gi)){console.log("contender, ready!");window.stop()}x(function(){w()})}function w(){if(settings.exceptions){exceptStrip=settings.exceptions.replace(/\s/g,"");exceptElements=exceptStrip.split(",");if(settings.replacement)var e=settings.replacement.replace(/\s/g,""),t=e.split(",");else t=!1;for(var n=0;n<exceptElements.length;n++){tag=exceptElements[n];E(tag,t)}}S(o)}function E(e,t){if(isClass(e)){var r=n.getElementsByClassName(e.replace(".",""));d.push(e.replace(".",""))}else if(isId(e)){var r=n.getElementById(e.replace("#",""));v.push(e.replace("#",""))}else{var r=n.getElementsByTagName(e);m.push(e)}if(!r)return;a.exceptions.length=0;a.replacements.length=0;for(var i=0;i<r.length;i++){var s=null;"src"in r[i]?s="src":"href"in r[i]&&(s="href");if(r[i][s]){replaceParts=r[i][s].split("/");replaceFile=replaceParts.slice(-1)[0];if(inArray(replaceFile,t)){newTarget="";for(var i=0;i<replaceParts.length;i++)i!==replaceParts.length-1&&(newTarget+=replaceParts[i]+"/");newTarget+=T(replaceFile);r[0][s]=newTarget;a.replacements.length++;a.replacements[0]=newTarget}else{r[i][s]=r[i][s];a.exceptions.length++;a.exceptions[i]=r[i][s]}}}}function S(e){i="";for(var r=0;r<e.length;r++)!hasClass(e[r].classList,d)&&!hasId(e[r].id,v)?e[r].src=T(e[r].src):e[r].src=e[r].src;g={exceptions:{files:a.exceptions,elements:m,classes:d,ids:v},elapsed:{sec:l.sec,ms:l.ms},images:n.images,identifier:c,network:a.network,replacements:a.replacements};t(g)}function x(e){var t=function(){var e=n.getElementsByTagName("script");for(var t=0;t<e.length;t++){selfParts=e[t].src.split("/");selfFile=selfParts.slice(-1)[0];if(inArray(selfFile,selfFiles))return e[t].src}}();t+="?mbdjs="+randString();start=(new Date).getTime();xmlhttp=new XMLHttpRequest;requestComplete=!1;requestState=0;xmlhttp.addEventListener("progress",function(e){u=(e.total/1024).toPrecision(2);f=(e.loaded/1024).toPrecision(2);if(f>1){xmlhttp.abort();requestComplete=!0}},!1);xmlhttp.open("HEAD",t,!0);xmlhttp.send();xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){l=(new Date).getTime()-start;elapsedSec=l/1e3;c="";a.network="";if(l>"630"){c="-3g";a.network="3G"}if(l>"1800"){c="-edge";a.network="EDGE"}if(l>"2000"){c="-edge-slow";a.network="EDGE (Slow)"}if(l>"3600"){c="-gprs";a.network="GPRS"}l={ms:l,sec:elapsedSec};e()}}}function T(e){newTarget=e;extension="."+e.substring(e.lastIndexOf(".")+1,e.length);if(settings.identifier&&a.network)var t=settings.identifier+extension;else var t=c+extension;newTarget=e.replace(extension,t);return newTarget}function N(e,t){for(var n in t)try{t[n].constructor===Object?e[n]=N(e[n],t[n]):e[n]=t[n]}catch(r){e[n]=t[n]}return e}var n=document,r=n.documentElement,i=r.style.visibility,s=0,o=n.images,u=!1,a=!1,f=!1,l=!1,c="",h=!1,p="",d=[],v=[],m=[],g=[];a={exceptions:{},replacements:{},network:""};settings={exceptions:"link,script",replacement:!1,identifier:!1};selfFiles=["mobbed.js","mobbed.min.js"];i="hidden";var y=setInterval(function(){if(document.body){b();clearInterval(y)}},10)},getElementsByClassName=function(e){var t=this.getElementsByTagName("*"),n,r={};for(n in t){var i=t[n].classList;for(c in i)i[c]==e&&r.elements[n].push(i[c])}return r};